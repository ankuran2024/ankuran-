<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Ankuran 2024</title>
    <link rel="stylesheet" href="styles.css">
    <style>
    body {
        font-family: 'Arial', sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        padding: 0;
        color: #333;
        background-image: url("black.gif");
        background-size: contain;
    }
    
    .profile-container {
        background-color: #090909;
        /* max-width: 260px; */
        max-width: 400px;
        margin: 50px auto;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        border: 2px solid #BF0904;
    }

    @media(max-width: 768px){
      .profile-container {
        background-color: #090909;
        max-width: 260px;
        /* max-width: 400px; */
        margin: 50px auto;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        border: 2px solid #BF0904;
    }
    }
    
    h1 {
        color: #BF0904; /* Deep purple */
        text-align: center;
    }
    
    p {
        font-size: 1.2rem;
        margin: 15px 0;
        color: white;
    }
    
    input[type="text"] {
        width: 95%;
        padding: 10px;
        margin: 5px 0 20px;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 1rem;
    }
    
    select {
        width: 100%;
        padding: 10px;
        margin: 5px 0 20px;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 1rem;
    }
    
    button {
        width: 100%;
        padding: 12px;
        background-color: #BF0904; /* Bright pink */
        color: white;
        border: none;
        border-radius: 4px;
        font-size: 1.1rem;
        cursor: pointer;
    }
    
    #profileForm label{
      color: white;
    }

    #logoutBtn{
      margin-top: 2rem;
    }

    button:hover {
        background-color: #BF0904; /* Darker pink on hover */
    }

    .text, .Email{
        display: flex;
        justify-content: center;
    }

    .text p{
        font-size: 1.3rem;
    }

    @media(max-width: 768px){
        .text, .Email{
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .text p{
        font-size: 1.1rem;
    }
    }
    </style>
</head>
<body>

  <header>
    <!-- Include your navbar here -->
    <div >
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About Us</a></li>
                <li><a href="events.html" class="active">Events</a></li>
                <li><a href="past-events.html">Past Events</a></li>
                <li><a href="contact.html">Contact</a></li>
                <!-- <li><a href="sponsors.html">Sponsors</a></li> -->
            </ul> 
            <div class="hamburger" onclick="toggleMenu()">&#9776;</div>
        </nav>
    </div>   
</header>

    <div class="profile-container">
        <h1>Profile <span id="username"></span></h1>
       <div class="Email">
        <p>Email: <span id="email"></span></p>
       </div>
        
        <form id="profileForm">
          <label for="name">Name</label>
          <input type="text" id="name" name="name">
          
          <label for="branch">Branch</label>
          <input type="text" id="branch" name="branch">
          
          <label for="year">Year</label>
          <input type="text" id="year" name="year">

          <div class="text">
            <p> Go to events section to register for events.</p>
          </div>
          
          <!-- <label for="eventParticipation">Event Participation</label>
          <select id="eventParticipation" name="eventParticipation">
              <option value="" disabled selected>Select an Event</option>
              <option value="roboRace">Robo Race</option>
              <option value="roboSoccer">Robo Soccer</option>
              <option value="roboSumo">Robo Sumo</option>
              <option value="waterRocket">Water Rocket</option>
              <option value="hackToInnovate">Hack to Innovate</option>
              <option value="technicalQuiz">Technical Quiz</option>
              <option value="codeClash">Code Clash</option>
              <option value="hackathonSoftware">Hackathon (Software)</option>
              <option value="openStage">Open Stage</option>
              <option value="fashionShow">Fashion Show</option>
              <option value="mushaira">Mushaira</option>
              <option value="captureMoments">Capture The Moments</option>
              <option value="rangoliMaking">Rangoli Making</option>
              <option value="funnyGames">Funny Games</option>
              <option value="cricket">Cricket</option>
              <option value="badmintonGirls">Badminton (Girls)</option>
              <option value="badminton">Badminton</option>
              <option value="football">Football</option>
              <option value="volleyball">Volleyball</option>
              <option value="tableTennis">Table Tennis</option>
              <option value="chess">Chess</option>
              <option value="tugOfWar">Tug of War</option>
              <option value="armWrestling">Arm Wrestling</option>
              <option value="race">Race</option>
              <option value="raceGirls">Race (Girls)</option>
              <option value="eSports">E-Sports</option>
          </select> -->
          
          <button type="submit">Update Info</button>
        </form>
        
        <button id="logoutBtn">Log Out</button>
    </div>

    <script src="script.js"></script>
    <script type="module">
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";
        import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-database.js";
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDyUtZ_uPF65ZbFRuHst_nmao6y0xbqev4",
            authDomain: "ankuran-2024.firebaseapp.com",
            projectId: "ankuran-2024",
            storageBucket: "ankuran-2024.appspot.com",
            messagingSenderId: "25175569346",
            appId: "1:25175569346:web:3ce91557b0438e18cddc5b",
            databaseURL: "https://ankuran-2024-default-rtdb.firebaseio.com/"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const database = getDatabase(app);
        let userRef;

        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('email').innerText = user.email;
                const userId = user.uid;
                userRef = ref(database, 'users/' + userId);

                onValue(userRef, (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        document.getElementById('name').value = data.name || '';
                        document.getElementById('branch').value = data.branch || '';
                        document.getElementById('year').value = data.year || '';
                        document.getElementById('eventParticipation').value = data.eventParticipation || '';
                    }
                });
            } else {
                window.location.href = 'login.html';
            }
        });

        document.getElementById('profileForm').addEventListener('submit', (e) => {
            e.preventDefault();

            const name = document.getElementById('name').value;
            const branch = document.getElementById('branch').value;
            const year = document.getElementById('year').value;
            const eventParticipation = document.getElementById('eventParticipation').value;

            set(userRef, {
                name,
                branch,
                year,
                eventParticipation
            }).then(() => {
                alert("Profile updated successfully!");
            }).catch((error) => {
                console.error("Error updating profile:", error);
            });
        });

        // Logout function
        document.getElementById('logoutBtn').addEventListener('click', () => {
            signOut(auth).then(() => {
                window.location.href = 'login.html';
            }).catch((error) => {
                console.error('Error logging out:', error);
            });
        });
    </script>
</body>
</html>
